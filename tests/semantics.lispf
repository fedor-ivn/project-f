(func eql (a b)
      (cond (and (islist a) (islist b))
            (equal-list a b)
            (equal a b)))

(func equalList (a b)
      (cond (isnull a) (return (isnull b)))
      (cond (isnull b) (return false))
      (cond (eql (head a) (head b))
            (equal-list (tail a) (tail b))
            false))

(func testMixedTypes ()
      (and
        (equal (plus 2 0.1) 2.1)
        (equal (minus 2 1.0) 1.0)))

(func testEmptyListIsSameAsNull ()
      (isnull ()))

(func testSetqReturnValue ()
      (equal (setq a 1) 1))

(func testHead ()
      (equal (head '(1 2 3)) 1))

(func testTail ()
      (and
        (equalList (tail '(1 2 3)) '(2 3))
        (isnull (tail ()))))

(func testCons ()
      (equalList (cons 1 '(2 3)) '(1 2 3)))

(func testProgScope1 ()
      (setq x 2)
      (prog (x) (setq x 3))
      (equal x 2))

(func testProgScope2 ()
      (setq x 2)
      (prog () (setq x 3))
      (equal x 3))

(func testFuncScope ()
      (setq x 2)
      (func foo (x) (setq x 3))
      (setq y (foo x))
      (equal x 2))

(func testLambda ()
      (setq increment (prog (counter)
                            (setq counter 0)
                            (lambda () (setq counter (plus counter 1)))))
      (and
        (equal (increment) 1)
        (equal (increment) 2)))

(func testEval ()
      (equal (eval '(plus 1 2)) 3))

(func testIsatom ()
      (setq x 1)
      (and
        (isatom 'x)
        (not (isatom x))))

(func testBreakFromProg ()
      (prog ()
            (cond true (break true))
            (divide 1 0)))

(func testReturnFromProg ()
      (prog ()
            (cond true (return true))
            (divide 1 0))
      (divide 2 0))
