(func testPlus ()
    (and (equal (plus 1 2) 3)
         (equal (plus 1 -2.0) -1.0)
         (equal (plus 0.125 1) 1.255)
         (equal (plus -0.25 0.5) 0.25)))

(func testMinus ()
    (and (equal (minus 3 1) 2)
         (equal (minus 1 3.0) -2.0)
         (equal (minus 0.75 1) -0.25)
         (equal (minus 0.75 -0.5) 1.25)))

(func testTimes ()
    (and (equal (times 3 1) 3)
         (equal (times -2 4.0) -8.0)
         (equal (times 1.5 2) 3.0)
         (equal (times 3.0 0.5) 1.5)))

(func testDivide ()
    (and (equal (divide 7 2) 3)
         (equal (divide 5.0 -2) -2.5)
         (equal (divide 2 0.5) 4.0)
         (equal (divide -5.0 -2.0) 2.5)))

(func testDouble ()
    (setq inf (divide 1.0 0.0))
    (setq negInf (divide -1.0 0.0))
    (setq nan (divide 0.0 0.0))

    (func isNan (x) (nonequal x x))

    (and (equal +0.0 -0.0)
         (isNan nan)
         (isNan (minus inf inf))
         (isNan (plus nan 4.0))
         (equal (plus negInf 1.0) negInf)
         (equal (minus 2.0 inf) negInf)))

(and (testPlus) (testMinus) (testTimes) (testDivide) (testDouble))
